import*as lpEditCurriculumShare from"./edit-curriculum/share.js";import*as sectionEdit from"./edit-curriculum/edit-section.js";import*as sectionItemEdit from"./edit-curriculum/edit-section-item.js";const{className:className}=lpEditCurriculumShare,toggleSectionAll=(t,e)=>{const i=e.closest(`${className.elToggleAllSections}`);if(!i)return;const c=lpEditCurriculumShare.elEditCurriculum.querySelectorAll(`${className.elSection}:not(.clone)`);i.classList.toggle(`${className.elCollapse}`),c.forEach(t=>{const e=i.classList.contains(`${className.elCollapse}`);t.classList.toggle(`${className.elCollapse}`,e)})},updateCountItems=t=>{const e=lpEditCurriculumShare.elEditCurriculum,i=e.querySelector(".total-items"),c=e.querySelectorAll(`${className.elSectionItem}:not(.clone)`).length;i.dataset.count=c,i.querySelector(".count").textContent=c;const o=t.querySelector(".section-items-counts"),s=t.querySelectorAll(`${className.elSectionItem}:not(.clone)`).length;o.dataset.count=s,o.querySelector(".count").textContent=s};document.addEventListener("click",t=>{const e=t.target;sectionEdit.addSection(t,e),sectionEdit.setFocusTitleInput(t,e),sectionEdit.toggleSection(t,e),sectionEdit.updateSectionDescription(t,e),sectionEdit.cancelSectionDescription(t,e),sectionEdit.deleteSection(t,e),sectionEdit.updateSectionTitle(t,e),sectionEdit.cancelSectionTitle(t,e),sectionItemEdit.addItemType(t,e),sectionItemEdit.cancelAddItemType(t,e),sectionItemEdit.addItemToSection(t,e),sectionItemEdit.showPopupItemsToSelect(t,e),sectionItemEdit.showItemsSelected(t,e),sectionItemEdit.chooseTabItemsType(t,e),sectionItemEdit.updateTitle(t,e),sectionItemEdit.cancelUpdateTitle(t,e),sectionItemEdit.deleteItem(t,e),sectionItemEdit.selectItemsFromList(t,e),sectionItemEdit.addItemsSelectedToSection(t,e),sectionItemEdit.backToSelectItems(t,e),sectionItemEdit.removeItemSelected(t,e),sectionItemEdit.updatePreviewItem(t,e),toggleSectionAll(0,e)}),document.addEventListener("keydown",t=>{const e=t.target;"Enter"===t.key&&(sectionEdit.addSection(t,e),sectionEdit.updateSectionTitle(t,e),sectionEdit.updateSectionDescription(t,e),sectionItemEdit.addItemToSection(t,e),sectionItemEdit.updateTitle(t,e))}),document.addEventListener("keyup",t=>{const e=t.target;sectionEdit.changeTitleBeforeAdd(t,e),sectionEdit.changeTitle(t,e),sectionEdit.changeDescription(t,e),sectionItemEdit.changeTitle(t,e),sectionItemEdit.changeTitleAddNew(t,e),sectionItemEdit.searchTitleItemToSelect(t,e)}),document.addEventListener("focusin",t=>{sectionEdit.focusTitleNewInput(t,t.target),sectionEdit.focusTitleInput(t,t.target),sectionItemEdit.focusTitleInput(t,t.target)}),document.addEventListener("focusout",t=>{sectionEdit.focusTitleNewInput(t,t.target,!1),sectionEdit.focusTitleInput(t,t.target,!1),sectionItemEdit.focusTitleInput(t,t.target,!1)}),window.addEventListener("beforeunload",function(t){0!==Object.keys(lpEditCurriculumShare.hasChange).length&&(t.preventDefault(),t.returnValue="")}),lpEditCurriculumShare.lpUtils.lpOnElementReady(`${className.idElEditCurriculum}`,t=>{const e=t.querySelector(`${className.elCurriculumSections}`),i=t.closest(`${className.LPTarget}`),c=window.lpAJAXG.getDataSetCurrent(i);lpEditCurriculumShare.setVariables({courseId:c.args.course_id,elEditCurriculum:t,elCurriculumSections:e,elLPTarget:i,updateCountItems:updateCountItems,hasChange:{}}),sectionEdit.init(),sectionEdit.sortAbleSection(),sectionItemEdit.init(),sectionItemEdit.sortAbleItem(),lpEditCurriculumShare.setVariable("sortAbleItem",sectionItemEdit.sortAbleItem)});